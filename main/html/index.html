<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="applicable-device" content="mobile">
  <meta name="viewport" content="width=device-width,initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5, user-scalable=no">
  <title>卧岚头条</title>
  <meta name="description" content="卧岚头条">
  <meta name="keywords" content="头条,卧岚头条">
  <link rel="stylesheet" type="text/css" href="../css/style.css">
</head>
<body ontouchstart>
  <div class="indexContainer withHeader">
    <header id="indexHeader" class="index-toutiao">
      <div class="top_bar">
        <div class="abs_m">
          <a href="#" class="refresh_title btn">卧岚头条</a>
          <div class="refreshBtn-container ">
            <i class="refresh_btn"></i>
          </div>
        </div>
        <div class="abs_l">
          <a href="javascript:;" class="rtn-box"></a>
        </div>
        <div class="abs_r">
          <a href="javascript:;" class="btn search"></a>
        </div>
      </div>
    </header>
    <div>
      <!-- channel start -->
      <div class="top_menu_bar">
        <div class="top_menu_more">
          <div class="list_shadow"></div>
          <a class="more_btn" href="javascript:void(0)"></a>
        </div>
        <div class="top_menu_list">
          <a href="#/" data-channel="recommend" data-query="" class="btn">推荐</a>
          <a href="#/hot" data-channel="hot" data-query="" class="btn">热点</a>
          <a href="#/society" data-channel="society" data-query="" class="btn">社会</a>
          <a href="#/car" data-channel="car" data-query="" class="btn">汽车</a>
          <a href="#/focus" data-channel="focus" data-query="" class="btn">关注</a>
          <a href="#/shanghai" data-channel="shanghai" data-query="" class="btn">上海</a>
          <a href="#/military" data-channel="military" data-query="" class="btn">军事</a>
          <a href="#/sports" data-channel="sports" data-query="" class="btn">体育</a>
          <a href="#/finance" data-channel="finance" data-query="" class="btn">财经</a>
        </div>
      </div>
      <!-- channel end -->
      <div id="div1" class="content0">
        <!-- content start -->
        <div class="scroll_bar">
          <div class="bar1">⇣</div>
          <div class="bar2">下拉刷新</div>
        </div>
        <div id="div2">
          <content id="pageletListContent" class="feed-list-container">
            <div class="list-content">
              <section class="has_action" data-hot-time="" data-group-id="" data-item-id="" data-format="">
                <a href="javascript: void(0)" data-action-label="click_headline" data-tag="news_politics" class="article_link clearfix ">
                  <div class="item_detail">
                    <h3 class="dotdot line2">
                      煤炉撤了天然气却不来，河北、山西、陕西的人为什么要白白受冻？
                    </h3>
                    <div class="item_info">
                      <div>
                        <span class="stick_label space">置顶</span>
                        <span class="src space">生活就是娱乐</span>
                        <span class="cmt space">评论 30</span>
                        <span class="time" title="2018-04-12 09:15">15分钟前</span>
                      </div>
                    </div>
                  </div>
                </a>
              </section>
              <section class="middle_mode has_action" data-hot-time="" data-group-id="" data-item-id="" data-format="">
                <a href="javascript: void(0)" data-action-label="" data-tag="" class="article_link clearfix ">
                  <div class="item_detail desc">
                    <h3 class="dotdot line2 image-margin-right">
                      煤炉撤了天然气却不来，河北、山西、陕西的人为什么要白白受冻？
                    </h3>
                    <div class="item_info">
                      <div>
                        <span class="hot_label space">热</span>
                        <span class="src space">生活就是娱乐</span>
                        <span class="cmt space">评论 30</span>
                      </div>
                    </div>
                  </div>
                  <div class="list_img_holder">
                    <img src="../images/new_picture.png">
                    <span class="video-btn"></span>
                  </div>
                </a>
              </section>
              <section class="has_action" data-hot-time="" data-group-id="" data-item-id="" data-format="">
                <a href="javascript: void(0)" data-action-label="" data-tag="" class="article_link clearfix">
                  <div class="item_detail">
                    <h3 class="dotdot line2">
                      煤炉撤了天然气却不来，河北、山西、陕西的人为什么要白白受冻？
                    </h3>
                    <div class="list_image">
                      <ul class="clearfix">
                        <li class="list_img_holder">
                          <img src="../images/QQ20180409-0.png">
                        </li>
                        <li class="list_img_holder">
                          <img src="../images/QQ20180409-1.png">
                        </li>
                        <li class="list_img_holder">
                          <img src="../images/QQ20180409-2.png">
                        </li>
                      </ul>
                    </div>
                    <div class="item_info">
                      <div>
                        <span class="src space">生活就是娱乐</span>
                        <span class="cmt space">评论30</span>
                        <span class="time" title="2018-04-12 09:34">1天前</span>
                      </div>
                    </div>
                  </div>
                </a>
              </section>
              <section class="has_action" data-hot-time="" data-group-id="" data-item-id="" data-format="0">
                <a href="javascript: void(0)" class="article_link clearfix " data-action-label="">
                  <h3 class="dotdot line2">
                    煤炉撤了天然气却不来，河北、山西、陕西的人为什么要白白受冻？
                  </h3>
                  <div class="list_img_holder_large">
                      <img src="../images/big_img-1.png">
                  </div>
                  <div class="item_info">
                    <span class="hot_label space">热</span>
                    <span class="cmt space">评论 30</span>
                    <span class="time" title="2018-04-11 14:09">1天前</span>
                  </div>
                </a>
              </section>
            </div>
            <div class="list_bottom">
              <section class="loadmoretip">
                <a href="#">加载中...</a>
              </section>
            </div>
          </content>
        </div>
        
        <!-- content end -->
      </div>
      
    </div>
  </div>
<!-- JavaScript -->
<script type="text/javascript" src="../js/mobile_fun.js"></script>
<script type="text/javascript" src="../js/router.js"></script>
<script type="text/javascript">
window.onload=function(){
  
  var isdrag = false;
  var NowTop = 100,
      flag   = false,
      moveY = 0,
      toTop = 0,
      disEndY=0,
      disY;
  var oDiv1 = document.getElementById("div1");
  var oDiv2 = document.getElementById("div2");
  oDiv2.addEventListener('touchstart', thismousedown);
  oDiv2.addEventListener('touchend', thismouseup);
  oDiv2.addEventListener('touchmove', thismousemove);

  function thismousedown(e) {
    // event.preventDefault();
    isdrag = true;
    disY = e.touches[0].pageY;
    return false;
  }

  function thismousemove(e) {
    // event.preventDefault();
    if(isdrag) {
      var x = e.touches[0].pageY - disY;
      //向下滑动
      if( x > 0 && Math.abs(x) < 120) {
         // oDiv1.css("top",(130+x)+"px");
        oDiv1.style.transform = "translate(0px, "+ x +"px)";
        
        flag = false;
        return false;
      }else if(x >= 120 && Math.abs(x) < 156){
        oDiv1.style.transform = "translate(0px, "+ x +"px)";
        document.querySelector(".bar1").innerHTML = '⇡';
        document.querySelector(".bar2").innerHTML = '释放刷新';
        console.log(x);
        flag = true;
        return false;
      } 
      
    }
  }

  function thismouseup(e) {
    isdrag = false;
    if(flag){
      document.querySelector(".refresh_btn").className += (' '+'rotate');//转动标题栏的图标
      document.querySelector(".bar1").innerHTML = '<img src="../images/onload.gif" alt="加载中" width="38">';
      document.querySelector(".bar2").innerHTML = '正在刷新';
      setTimeout(function () {
        document.location.reload();//1秒后重新加载当前页面
        //$(".list-content").html("内容已经重新加载");
      }, 1000);
    }else{
      oDiv1.style.transform = "translate(0px, -4px)";
    }     
  };
  //滚动加载
  window.onscroll = function(){
　　if(getScrollTop() + getWindowHeight() >= getScrollHeight()){
　　　ajaxJSON("GET","http://houyishuai.dev.dc.wallan-tech.com").then(function(data) 
      {
        console.log(data);
        let ajaxData = document.createElement("div");
        ajaxData.innerHTML=`
          <section class="has_action" data-hot-time="" data-group-id="" data-item-id="" data-format="">
                <a href="javascript: void(0)" data-action-label="click_headline" data-tag="news_politics" class="article_link clearfix ">
                  <div class="item_detail">
                    <h3 class="dotdot line2">
                      煤炉撤了天然气却不来，河北、山西、陕西的人为什么要白白受冻？
                    </h3>
                    <div class="item_info">
                      <div>
                        <span class="stick_label space">置顶</span>
                        <span class="src space">生活就是娱乐</span>
                        <span class="cmt space">评论 30</span>
                        <span class="time" title="2018-04-12 09:15">15分钟前</span>
                      </div>
                    </div>
                  </div>
                </a>
              </section>
              <section class="middle_mode has_action" data-hot-time="" data-group-id="" data-item-id="" data-format="">
                <a href="javascript: void(0)" data-action-label="" data-tag="" class="article_link clearfix ">
                  <div class="item_detail desc">
                    <h3 class="dotdot line2 image-margin-right">
                      煤炉撤了天然气却不来，河北、山西、陕西的人为什么要白白受冻？
                    </h3>
                    <div class="item_info">
                      <div>
                        <span class="hot_label space">热</span>
                        <span class="src space">生活就是娱乐</span>
                        <span class="cmt space">评论 30</span>
                      </div>
                    </div>
                  </div>
                  <div class="list_img_holder">
                    <img src="../images/new_picture.png">
                    <span class="video-btn"></span>
                  </div>
                </a>
              </section>
              <section class="has_action" data-hot-time="" data-group-id="" data-item-id="" data-format="">
                <a href="javascript: void(0)" data-action-label="" data-tag="" class="article_link clearfix">
                  <div class="item_detail">
                    <h3 class="dotdot line2">
                      煤炉撤了天然气却不来，河北、山西、陕西的人为什么要白白受冻？
                    </h3>
                    <div class="list_image">
                      <ul class="clearfix">
                        <li class="list_img_holder">
                          <img src="../images/QQ20180409-0.png">
                        </li>
                        <li class="list_img_holder">
                          <img src="../images/QQ20180409-1.png">
                        </li>
                        <li class="list_img_holder">
                          <img src="../images/QQ20180409-2.png">
                        </li>
                      </ul>
                    </div>
                    <div class="item_info">
                      <div>
                        <span class="src space">生活就是娱乐</span>
                        <span class="cmt space">评论30</span>
                        <span class="time" title="2018-04-12 09:34">1天前</span>
                      </div>
                    </div>
                  </div>
                </a>
              </section>
              <section class="has_action" data-hot-time="" data-group-id="" data-item-id="" data-format="0">
                <a href="javascript: void(0)" class="article_link clearfix " data-action-label="">
                  <h3 class="dotdot line2">
                    煤炉撤了天然气却不来，河北、山西、陕西的人为什么要白白受冻？
                  </h3>
                  <div class="list_img_holder_large">
                      <img src="../images/big_img-1.png">
                  </div>
                  <div class="item_info">
                    <span class="hot_label space">热</span>
                    <span class="cmt space">评论 30</span>
                    <span class="time" title="2018-04-11 14:09">1天前</span>
                  </div>
                </a>
              </section>`;
        document.querySelector(".list-content").append(ajaxData);   
  　　}, function(error){
        console.error('出错了', error);
      });
    }
  };
  
};
</script>
</body>
</html>


       



       